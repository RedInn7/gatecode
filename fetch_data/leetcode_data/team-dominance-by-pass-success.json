{
  "questionId": "3719",
  "questionFrontendId": "3384",
  "title": "Team Dominance by Pass Success",
  "titleSlug": "team-dominance-by-pass-success",
  "content": "<p>Table: <code>Teams</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| player_id   | int     |\n| team_name   | varchar | \n+-------------+---------+\nplayer_id is the unique key for this table.\nEach row contains the unique identifier for player and the name of one of the teams participating in that match.\n\n</pre>\n\n<p>Table: <code>Passes</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| pass_from   | int     |\n| time_stamp  | varchar |\n| pass_to     | int     |\n+-------------+---------+\n(pass_from, time_stamp) is the primary key for this table.\npass_from is a foreign key to player_id from Teams table.\nEach row represents a pass made during a match, time_stamp represents the time in minutes (00:00-90:00) when the pass was made,\npass_to is the player_id of the player receiving the pass.\n\n</pre>\n\n<p>Write a solution to calculate the <strong>dominance score</strong> for each team in<strong> both halves of the match</strong>. The rules are as follows:</p>\n\n<ul>\n\t<li>A match is divided into two halves: <strong>first half</strong> (<code>00:00</code>-<code><font face=\"monospace\">45:00</font></code>&nbsp;minutes) and <strong>second half </strong>(<code>45:01</code>-<code>90:00</code> minutes)</li>\n\t<li>The dominance score is calculated based on successful and intercepted passes:\n\t<ul>\n\t\t<li>When pass_to is a player from the <strong>same team</strong>: +<code>1</code> point</li>\n\t\t<li>When pass_to is a player from the <strong>opposing team</strong> (interception): <code>-1</code> point</li>\n\t</ul>\n\t</li>\n\t<li>A higher dominance score indicates better passing performance</li>\n</ul>\n\n<p>Return <em>the result table ordered </em><em>by</em>&nbsp;<code>team_name</code> and&nbsp;<code>half_number</code> <em>in <strong>ascending</strong> order</em>.</p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong></p>\n\n<p>Teams table:</p>\n\n<pre class=\"example-io\">\n+------------+-----------+\n| player_id  | team_name |\n+------------+-----------+\n| 1          | Arsenal   |\n| 2          | Arsenal   |\n| 3          | Arsenal   |\n| 4          | Chelsea   |\n| 5          | Chelsea   |\n| 6          | Chelsea   |\n+------------+-----------+\n</pre>\n\n<p>Passes table:</p>\n\n<pre class=\"example-io\">\n+-----------+------------+---------+\n| pass_from | time_stamp | pass_to |\n+-----------+------------+---------+\n| 1         | 00:15      | 2       |\n| 2         | 00:45      | 3       |\n| 3         | 01:15      | 1       |\n| 4         | 00:30      | 1       |\n| 2         | 46:00      | 3       |\n| 3         | 46:15      | 4       |\n| 1         | 46:45      | 2       |\n| 5         | 46:30      | 6       |\n+-----------+------------+---------+\n</pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"example-io\">\n+-----------+-------------+-----------+\n| team_name | half_number | dominance |\n+-----------+-------------+-----------+\n| Arsenal   | 1           | 3         |\n| Arsenal   | 2           | 1         |\n| Chelsea   | 1           | -1        |\n| Chelsea   | 2           | 1         |\n+-----------+-------------+-----------+\n</pre>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>First Half (00:00-45:00):</strong>\n\n\t<ul>\n\t\t<li>Arsenal&#39;s passes:\n\t\t<ul>\n\t\t\t<li>1 &rarr; 2 (00:15): Successful pass (+1)</li>\n\t\t\t<li>2 &rarr; 3 (00:45): Successful pass (+1)</li>\n\t\t\t<li>3 &rarr; 1 (01:15): Successful pass (+1)</li>\n\t\t</ul>\n\t\t</li>\n\t\t<li>Chelsea&#39;s passes:\n\t\t<ul>\n\t\t\t<li>4 &rarr; 1 (00:30): Intercepted by Arsenal (-1)</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n\t<li><strong>Second Half (45:01-90:00):</strong>\n\t<ul>\n\t\t<li>Arsenal&#39;s passes:\n\t\t<ul>\n\t\t\t<li>2 &rarr; 3 (46:00): Successful pass (+1)</li>\n\t\t\t<li>3 &rarr; 4 (46:15): Intercepted by Chelsea (-1)</li>\n\t\t\t<li>1 &rarr; 2 (46:45): Successful pass (+1)</li>\n\t\t</ul>\n\t\t</li>\n\t\t<li>Chelsea&#39;s passes:\n\t\t<ul>\n\t\t\t<li>5 &rarr; 6 (46:30): Successful pass (+1)</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n\t<li>The results are ordered by team_name and then half_number</li>\n</ul>\n</div>\n",
  "difficulty": "Hard",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "PostgreSQL",
      "code": "-- Write your PostgreSQL query statement below\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    },
    {
      "lang": "Pandas",
      "code": "import pandas as pd\n\ndef calculate_team_dominance(teams: pd.DataFrame, passes: pd.DataFrame) -> pd.DataFrame:\n    "
    }
  ],
  "stats": "{\"totalAccepted\": \"1.4K\", \"totalSubmission\": \"1.9K\", \"totalAcceptedRaw\": 1380, \"totalSubmissionRaw\": 1915, \"acRate\": \"72.1%\"}",
  "metaData": "{\"mysql\": [\"CREATE TABLE If not exists Teams (\\n    player_id INT,\\n    team_name VARCHAR(100)\\n)\\n\\n\", \"CREATE TABLE if not exists Passes (\\n    pass_from INT,\\n    time_stamp VARCHAR(5),\\n    pass_to INT\\n)\"], \"mssql\": [\"CREATE TABLE Teams (\\n    player_id INT,\\n    team_name VARCHAR(100)\\n)\\n\", \"\\nCREATE TABLE Passes (\\n    pass_from INT,\\n    time_stamp VARCHAR(5),\\n    pass_to INT\\n)\"], \"oraclesql\": [\"CREATE TABLE Teams (\\n    player_id NUMBER,\\n    team_name VARCHAR2(100)\\n)\\n\\n\", \"CREATE TABLE Passes (\\n    pass_from NUMBER,\\n    time_stamp VARCHAR2(5),\\n    pass_to NUMBER\\n)\"], \"database\": true, \"name\": \"calculate_team_dominance\", \"postgresql\": [\"CREATE TABLE IF NOT EXISTS Teams (\\n    player_id INTEGER,\\n    team_name VARCHAR(100)\\n);\\n\", \"CREATE TABLE IF NOT EXISTS Passes (\\n    pass_from INTEGER,\\n    time_stamp VARCHAR(5),\\n    pass_to INTEGER\\n);\\n\"], \"pythondata\": [\"Teams = pd.DataFrame(columns=[\\\"player_id\\\", \\\"team_name\\\"]).astype({\\\"player_id\\\": \\\"int\\\", \\\"team_name\\\": \\\"string\\\"})\\n\", \"Passes = pd.DataFrame(columns=[\\\"pass_from\\\", \\\"time_stamp\\\", \\\"pass_to\\\"]).astype({\\\"pass_from\\\": \\\"int\\\", \\\"time_stamp\\\": \\\"string\\\", \\\"pass_to\\\": \\\"int\\\"})\\n\"], \"database_schema\": {\"Teams\": {\"player_id\": \"INT\", \"team_name\": \"VARCHAR(100)\"}, \"Passes\": {\"pass_from\": \"INT\", \"time_stamp\": \"VARCHAR(5)\", \"pass_to\": \"INT\"}}}",
  "sampleTestCase": "{\"headers\":{\"Teams\":[\"player_id\",\"team_name\"],\"Passes\":[\"pass_from\",\"time_stamp\",\"pass_to\"]},\"rows\":{\"Teams\":[[1,\"Arsenal\"],[2,\"Arsenal\"],[3,\"Arsenal\"],[4,\"Chelsea\"],[5,\"Chelsea\"],[6,\"Chelsea\"]],\"Passes\":[[1,\"00:15\",2],[2,\"00:45\",3],[3,\"01:15\",1],[4,\"00:30\",1],[2,\"46:00\",3],[3,\"46:15\",4],[1,\"46:45\",2],[5,\"46:30\",6]]}}"
}