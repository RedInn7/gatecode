{
  "questionId": "3400",
  "questionFrontendId": "3089",
  "title": "Find Bursty Behavior",
  "titleSlug": "find-bursty-behavior",
  "content": "<p>Table: <code>Posts</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| post_id     | int     |\n| user_id     | int     |\n| post_date   | date    |\n+-------------+---------+\npost_id is the primary key (column with unique values) for this table.\nEach row of this table contains post_id, user_id, and post_date.\n</pre>\n\n<p>Write a solution to find users who demonstrate <strong>bursty behavior</strong> in their posting patterns during February <code>2024</code>. <strong>Bursty behavior</strong> is defined as <strong>any</strong> period of <strong>7</strong> <strong>consecutive</strong> days where a user&#39;s posting frequency is <strong>at least twice</strong> to their <strong>average</strong> weekly posting frequency for February <code>2024</code>.</p>\n\n<p><strong>Note:</strong> Only include the dates from February <code>1</code> to February <code>28</code> in your analysis, which means you should count February as having exactly <code>4</code> weeks.</p>\n\n<p>Return <em>the result table orderd by </em><code>user_id</code><em> in </em><strong>ascending</strong><em> order.</em></p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong></p>\n\n<p>Posts table:</p>\n\n<pre class=\"example-io\">\n+---------+---------+------------+\n| post_id | user_id | post_date  |\n+---------+---------+------------+\n| 1       | 1       | 2024-02-27 |\n| 2       | 5       | 2024-02-06 |\n| 3       | 3       | 2024-02-25 |\n| 4       | 3       | 2024-02-14 |\n| 5       | 3       | 2024-02-06 |\n| 6       | 2       | 2024-02-25 |\n+---------+---------+------------+\n</pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"example-io\">\n+---------+----------------+------------------+\n| user_id | max_7day_posts | avg_weekly_posts |\n+---------+----------------+------------------+\n| 1       | 1              | 0.2500           |\n| 2       | 1              | 0.2500           |\n| 5       | 1              | 0.2500           |\n+---------+----------------+------------------+\n</pre>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>User 1:</strong> Made only 1 post in February, resulting in an average of 0.25 posts per week and a max of 1 post in any 7-day period.</li>\n\t<li><strong>User 2:</strong> Also made just 1 post, with the same average and max 7-day posting frequency as User 1.</li>\n\t<li><strong>User 5:</strong> Like Users 1 and 2, User 5 made only 1 post throughout February, leading to the same average and max 7-day posting metrics.</li>\n\t<li><strong>User 3:</strong> Although User 3 made more posts than the others (3 posts), they did not reach twice the average weekly posts in their consecutive 7-day window, so they are not listed in the output.</li>\n</ul>\n\n<p><b>Note:</b> Output table is ordered by user_id in ascending order.</p>\n</div>\n",
  "difficulty": "Medium",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "PostgreSQL",
      "code": "-- Write your PostgreSQL query statement below\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    },
    {
      "lang": "Pandas",
      "code": "import pandas as pd\n\ndef find_bursty_behavior(posts: pd.DataFrame) -> pd.DataFrame:\n    "
    }
  ],
  "stats": "{\"totalAccepted\": \"2.4K\", \"totalSubmission\": \"6.3K\", \"totalAcceptedRaw\": 2357, \"totalSubmissionRaw\": 6277, \"acRate\": \"37.5%\"}",
  "metaData": "{\"mysql\": [\"Create table If Not Exists Posts (post_id int, user_id int,  post_date date)\"], \"mssql\": [\"Create table Posts (post_id int, user_id int,  post_date date)\"], \"oraclesql\": [\"Create table Posts (post_id int, user_id int,  post_date date)\", \"ALTER SESSION SET nls_date_format='YYYY-MM-DD'\"], \"database\": true, \"name\": \"find_bursty_behavior\", \"pythondata\": [\"Posts = pd.DataFrame([], columns=['post_id', 'user_id', 'post_date']).astype({'post_id':'Int64', 'user_id':'Int64', 'post_date':'datetime64[ns]'})\\n\"], \"postgresql\": [\"CREATE TABLE Posts (\\n    post_id int,\\n    user_id int,\\n    post_date date\\n);\\n\", \"SELECT TO_CHAR(post_date, 'YYYY-MM-DD') AS formatted_post_date FROM Posts;\\n\"], \"database_schema\": {\"Posts\": {\"post_id\": \"INT\", \"user_id\": \"INT\", \"post_date\": \"DATE\"}}}",
  "sampleTestCase": "{\"headers\": {\"Posts\": [\"post_id\", \"user_id\", \"post_date\"]}, \"rows\": {\"Posts\": [[1, 1, \"2024-02-27\"], [2, 5, \"2024-02-06\"], [3, 3, \"2024-02-25\"], [4, 3, \"2024-02-14\"], [5, 3, \"2024-02-06\"], [6, 2, \"2024-02-25\"]]}}"
}