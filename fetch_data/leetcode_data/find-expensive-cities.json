{
  "questionId": "3284",
  "questionFrontendId": "2987",
  "title": "Find Expensive Cities",
  "titleSlug": "find-expensive-cities",
  "content": "<p>Table: <code>Listings</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| listing_id  | int     |\n| city        | varchar |\n| price       | int     |\n+-------------+---------+\nlisting_id is column of unique values for this table.\nThis table contains listing_id, city, and price.\n</pre>\n\n<p>Write a solution to find <strong>cities </strong>where the <strong>average home prices</strong> exceed the <strong>national</strong> average home price.</p>\n\n<p>Return <em>the result table sorted by </em><code>city</code><em> in <strong>ascending</strong> order</em><em>.</em></p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nListings table:\n+------------+--------------+---------+\n| listing_id | city         | price   | \n+------------+--------------+---------+\n| 113        | LosAngeles   | 7560386 | \n| 136        | SanFrancisco | 2380268 |     \n| 92         | Chicago      | 9833209 | \n| 60         | Chicago      | 5147582 | \n| 8          | Chicago      | 5274441 |  \n| 79         | SanFrancisco | 8372065 | \n| 37         | Chicago      | 7939595 | \n| 53         | LosAngeles   | 4965123 | \n| 178        | SanFrancisco | 999207  | \n| 51         | NewYork      | 5951718 | \n| 121        | NewYork      | 2893760 | \n+------------+--------------+---------+\n<strong>Output</strong>\n+------------+\n| city       | \n+------------+\n| Chicago    | \n| LosAngeles |  \n+------------+\n<strong>Explanation</strong>\nThe national average home price is $6,122,059.45. Among the cities listed:\n- Chicago has an average price of $7,048,706.75\n- Los Angeles has an average price of $6,277,754.5\n- San Francisco has an average price of $3,900,513.33\n- New York has an average price of $4,422,739\nOnly Chicago and Los Angeles have average home prices exceeding the national average. Therefore, these two cities are included in the output table. The output table is sorted in ascending order based on the city names.\n\n</pre>\n",
  "difficulty": "Easy",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "PostgreSQL",
      "code": "-- Write your PostgreSQL query statement below\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    },
    {
      "lang": "Pandas",
      "code": "import pandas as pd\n\ndef find_expensive_cities(listings: pd.DataFrame) -> pd.DataFrame:\n    "
    }
  ],
  "stats": "{\"totalAccepted\": \"5.6K\", \"totalSubmission\": \"7.2K\", \"totalAcceptedRaw\": 5585, \"totalSubmissionRaw\": 7247, \"acRate\": \"77.1%\"}",
  "metaData": "{\"mysql\": [\"Create Table if Not Exists Listings (listing_id int, city varchar(50), price int)\"], \"mssql\": [\"Create Table Listings (listing_id int, city varchar(50), price int)\"], \"oraclesql\": [\"Create Table  Listings (listing_id int, city varchar(50), price int)\"], \"database\": true, \"name\": \"find_expensive_cities\", \"postgresql\": [\"CREATE TABLE Listings (\\n  listing_id SERIAL PRIMARY KEY,\\n  city VARCHAR(50),\\n  price INT\\n);\\n\"], \"pythondata\": [\"Listings = pd.DataFrame([], columns=['listing_id', 'city', 'price']).astype({'listing_id':'Int64', 'city':'object', 'price':'Int64'})\\n\"], \"database_schema\": {\"Listings\": {\"listing_id\": \"INT\", \"city\": \"VARCHAR(50)\", \"price\": \"INT\"}}}",
  "sampleTestCase": "{\"headers\":{\"Listings\":[\"listing_id\",\"city\",\"price\"]},\"rows\":{\"Listings\":[[113,\"LosAngeles\",7560386],[136,\"SanFrancisco\",2380268],[92,\"Chicago\",9833209],[60,\"Chicago\",5147582],[8,\"Chicago\",5274441],[79,\"SanFrancisco\",8372065],[37,\"Chicago\",7939595],[53,\"LosAngeles\",4965123],[178,\"SanFrancisco\",999207],[51,\"NewYork\",5951718],[121,\"NewYork\",2893760]]}}"
}