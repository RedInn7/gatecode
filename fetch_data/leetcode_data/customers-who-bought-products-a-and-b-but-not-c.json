{
  "questionId": "1536",
  "questionFrontendId": "1398",
  "title": "Customers Who Bought Products A and B but Not C",
  "titleSlug": "customers-who-bought-products-a-and-b-but-not-c",
  "content": "<p>Table: <code>Customers</code></p>\n\n<pre>\n+---------------------+---------+\n| Column Name         | Type    |\n+---------------------+---------+\n| customer_id         | int     |\n| customer_name       | varchar |\n+---------------------+---------+\ncustomer_id is the column with unique values for this table.\ncustomer_name is the name of the customer.</pre>\n\n<p>&nbsp;</p>\n\n<p>Table: <code>Orders</code></p>\n\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| order_id      | int     |\n| customer_id   | int     |\n| product_name  | varchar |\n+---------------+---------+\norder_id is the column with unique values for this table.\ncustomer_id is the id of the customer who bought the product &quot;product_name&quot;.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Write a solution&nbsp;to report the customer_id and customer_name of customers who bought products <strong>&quot;A&quot;</strong>, <strong>&quot;B&quot;</strong> but did not buy the product <strong>&quot;C&quot;</strong> since we want to recommend them to purchase this product.</p>\n\n<p>Return the result table <strong>ordered</strong> by <code>customer_id</code>.</p>\n\n<p>The&nbsp;result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nCustomers table:\n+-------------+---------------+\n| customer_id | customer_name |\n+-------------+---------------+\n| 1           | Daniel        |\n| 2           | Diana         |\n| 3           | Elizabeth     |\n| 4           | Jhon          |\n+-------------+---------------+\nOrders table:\n+------------+--------------+---------------+\n| order_id   | customer_id  | product_name  |\n+------------+--------------+---------------+\n| 10         |     1        |     A         |\n| 20         |     1        |     B         |\n| 30         |     1        |     D         |\n| 40         |     1        |     C         |\n| 50         |     2        |     A         |\n| 60         |     3        |     A         |\n| 70         |     3        |     B         |\n| 80         |     3        |     D         |\n| 90         |     4        |     C         |\n+------------+--------------+---------------+\n<strong>Output:</strong> \n+-------------+---------------+\n| customer_id | customer_name |\n+-------------+---------------+\n| 3           | Elizabeth     |\n+-------------+---------------+\n<strong>Explanation:</strong> Only the customer_id with id 3 bought the product A and B but not the product C.\n</pre>\n",
  "difficulty": "Medium",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "PostgreSQL",
      "code": "-- Write your PostgreSQL query statement below\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    },
    {
      "lang": "Pandas",
      "code": "import pandas as pd\n\ndef find_customers(customers: pd.DataFrame, orders: pd.DataFrame) -> pd.DataFrame:\n    "
    }
  ],
  "stats": "{\"totalAccepted\": \"68.1K\", \"totalSubmission\": \"95.2K\", \"totalAcceptedRaw\": 68091, \"totalSubmissionRaw\": 95212, \"acRate\": \"71.5%\"}",
  "metaData": "{\"mysql\": [\"Create table If Not Exists Customers (customer_id int, customer_name varchar(30))\", \"Create table If Not Exists Orders (order_id int, customer_id int, product_name varchar(30))\"], \"mssql\": [\"Create table Customers (customer_id int, customer_name varchar(30))\", \"Create table Orders (order_id int, customer_id int, product_name varchar(30))\"], \"oraclesql\": [\"Create table Customers (customer_id int, customer_name varchar(30))\", \"Create table Orders (order_id int, customer_id int, product_name varchar(30))\"], \"database\": true, \"name\": \"find_customers\", \"pythondata\": [\"Customers = pd.DataFrame([], columns=['customer_id', 'customer_name']).astype({'customer_id':'Int64', 'customer_name':'object'})\", \"Orders = pd.DataFrame([], columns=['order_id', 'customer_id', 'product_name']).astype({'order_id':'Int64', 'customer_id':'Int64', 'product_name':'object'})\"], \"postgresql\": [\"\\nCreate table If Not Exists Customers (customer_id int, customer_name varchar(30))\\n\", \"Create table If Not Exists Orders (order_id int, customer_id int, product_name varchar(30))\"], \"database_schema\": {\"Customers\": {\"customer_id\": \"INT\", \"customer_name\": \"VARCHAR(30)\"}, \"Orders\": {\"order_id\": \"INT\", \"customer_id\": \"INT\", \"product_name\": \"VARCHAR(30)\"}}}",
  "sampleTestCase": "{\"headers\":{\"Customers\":[\"customer_id\",\"customer_name\"],\"Orders\":[\"order_id\",\"customer_id\",\"product_name\"]},\"rows\":{\"Customers\":[[1,\"Daniel\"],[2,\"Diana\"],[3,\"Elizabeth\"],[4,\"Jhon\"]],\"Orders\":[[10,1,\"A\"],[20,1,\"B\"],[30,1,\"D\"],[40,1,\"C\"],[50,2,\"A\"],[60,3,\"A\"],[70,3,\"B\"],[80,3,\"D\"],[90,4,\"C\"]]}}"
}