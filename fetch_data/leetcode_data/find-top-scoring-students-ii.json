{
  "questionId": "3503",
  "questionFrontendId": "3188",
  "title": "Find Top Scoring Students II",
  "titleSlug": "find-top-scoring-students-ii",
  "content": "<p>Table: <code>students</code></p>\n\n<pre>\n+-------------+----------+\n| Column Name | Type     | \n+-------------+----------+\n| student_id  | int      |\n| name        | varchar  |\n| major       | varchar  |\n+-------------+----------+\nstudent_id is the primary key for this table. \nEach row contains the student ID, student name, and their major.\n</pre>\n\n<p>Table: <code>courses</code></p>\n\n<pre>\n+-------------+-------------------+\n| Column Name | Type              |       \n+-------------+-------------------+\n| course_id   | int               |    \n| name        | varchar           |      \n| credits     | int               |           \n| major       | varchar           |       \n| mandatory   | enum              |      \n+-------------+-------------------+\ncourse_id is the primary key for this table. \nmandatory is an enum type of (&#39;Yes&#39;, &#39;No&#39;).\nEach row contains the course ID, course name, credits, major it belongs to, and whether the course is mandatory.\n</pre>\n\n<p>Table: <code>enrollments</code></p>\n\n<pre>\n+-------------+----------+\n| Column Name | Type     | \n+-------------+----------+\n| student_id  | int      |\n| course_id   | int      |\n| semester    | varchar  |\n| grade       | varchar  |\n| GPA         | decimal  | \n+-------------+----------+\n(student_id, course_id, semester) is the primary key (combination of columns with unique values) for this table.\nEach row contains the student ID, course ID, semester, and grade received.\n</pre>\n\n<p>Write a solution to find the students who meet the following criteria:</p>\n\n<ul>\n\t<li>Have<strong> taken all mandatory courses</strong> and <strong>at least two</strong> elective courses offered in <strong>their major.</strong></li>\n\t<li>Achieved a grade of <strong>A</strong>&nbsp;in <strong>all mandatory courses</strong> and at least <strong>B</strong>&nbsp;in<strong> elective courses</strong>.</li>\n\t<li>Maintained an average <code>GPA</code> of at least&nbsp;<code>2.5</code> across all their courses (including those outside their major).</li>\n</ul>\n\n<p>Return <em>the result table ordered by</em> <code>student_id</code> <em>in <strong>ascending</strong> order</em>.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong></p>\n\n<p>students table:</p>\n\n<pre class=\"example-io\">\n +------------+------------------+------------------+\n | student_id | name             | major            |\n +------------+------------------+------------------+\n | 1          | Alice            | Computer Science |\n | 2          | Bob              | Computer Science |\n | 3          | Charlie          | Mathematics      |\n | 4          | David            | Mathematics      |\n +------------+------------------+------------------+\n </pre>\n\n<p>courses table:</p>\n\n<pre class=\"example-io\">\n +-----------+-------------------+---------+------------------+----------+\n | course_id | name              | credits | major            | mandatory|\n +-----------+-------------------+---------+------------------+----------+\n | 101       | Algorithms        | 3       | Computer Science | yes      |\n | 102       | Data Structures   | 3       | Computer Science | yes      |\n | 103       | Calculus          | 4       | Mathematics      | yes      |\n | 104       | Linear Algebra    | 4       | Mathematics      | yes      |\n | 105       | Machine Learning  | 3       | Computer Science | no       |\n | 106       | Probability       | 3       | Mathematics      | no       |\n | 107       | Operating Systems | 3       | Computer Science | no       |\n | 108       | Statistics        | 3       | Mathematics      | no       |\n +-----------+-------------------+---------+------------------+----------+\n </pre>\n\n<p>enrollments table:</p>\n\n<pre class=\"example-io\">\n +------------+-----------+-------------+-------+-----+\n | student_id | course_id | semester    | grade | GPA |\n +------------+-----------+-------------+-------+-----+\n | 1          | 101       | Fall 2023   | A     | 4.0 |\n | 1          | 102       | Spring 2023 | A     | 4.0 |\n | 1          | 105       | Spring 2023 | A     | 4.0 |\n | 1          | 107       | Fall 2023   | B     | 3.5 |\n | 2          | 101       | Fall 2023   | A     | 4.0 |\n | 2          | 102       | Spring 2023 | B     | 3.0 |\n | 3          | 103       | Fall 2023   | A     | 4.0 |\n | 3          | 104       | Spring 2023 | A     | 4.0 |\n | 3          | 106       | Spring 2023 | A     | 4.0 |\n | 3          | 108       | Fall 2023   | B     | 3.5 |\n | 4          | 103       | Fall 2023   | B     | 3.0 |\n | 4          | 104       | Spring 2023 | B     | 3.0 |\n +------------+-----------+-------------+-------+-----+\n </pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"example-io\">\n +------------+\n | student_id |\n +------------+\n | 1          |\n | 3          |\n +------------+\n </pre>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li>Alice (student_id 1) is a Computer Science major and has taken both Algorithms&nbsp;and Data Structures, receiving an A&nbsp;in both. She has also taken Machine Learning&nbsp;and Operating Systems&nbsp;as electives, receiving an A&nbsp;and B&nbsp;respectively.</li>\n\t<li>Bob (student_id 2) is a Computer Science major but did not receive an A&nbsp;in all required courses.</li>\n\t<li>Charlie (student_id 3) is a Mathematics major and has taken both Calculus&nbsp;and Linear Algebra, receiving an A&nbsp;in both. He has also taken Probability&nbsp;and Statistics&nbsp;as electives, receiving an A&nbsp;and B&nbsp;respectively.</li>\n\t<li>David (student_id 4) is a Mathematics major but did not receive an A&nbsp;in all required courses.</li>\n</ul>\n\n<p><strong>Note:</strong> Output table is ordered by student_id in ascending order.</p>\n</div>\n",
  "difficulty": "Hard",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "PostgreSQL",
      "code": "-- Write your PostgreSQL query statement below\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    },
    {
      "lang": "Pandas",
      "code": "import pandas as pd\n\ndef find_top_scoring_students(students: pd.DataFrame, courses: pd.DataFrame, enrollments: pd.DataFrame) -> pd.DataFrame:\n    "
    }
  ],
  "stats": "{\"totalAccepted\": \"2.2K\", \"totalSubmission\": \"5.5K\", \"totalAcceptedRaw\": 2181, \"totalSubmissionRaw\": 5549, \"acRate\": \"39.3%\"}",
  "metaData": "{\"mysql\": [\"CREATE TABLE if not exists students (\\n    student_id INT ,\\n    name VARCHAR(255),\\n    major VARCHAR(255)\\n)\", \"CREATE TABLE if not exists courses (\\n    course_id INT ,\\n    name VARCHAR(255),\\n    credits INT,\\n    major VARCHAR(255),\\n    mandatory ENUM('yes', 'no') DEFAULT 'no'\\n)\", \"CREATE TABLE  if not exists enrollments (\\n    student_id INT,\\n    course_id INT,\\n    semester VARCHAR(255),\\n    grade VARCHAR(10),\\nGPA decimal(3,2)\\n\\n);\"], \"mssql\": [\"CREATE TABLE students (\\n    student_id INT ,\\n    name VARCHAR(255),\\n    major VARCHAR(255)\\n)\", \"CREATE TABLE courses (\\n    course_id INT PRIMARY KEY,\\n    name VARCHAR(255),\\n    credits INT,\\n    major VARCHAR(255),\\n    mandatory VARCHAR(3) CHECK (mandatory IN ('yes', 'no')) DEFAULT 'no'\\n)\", \"CREATE TABLE enrollments (\\n    student_id INT,\\n    course_id INT,\\n    semester VARCHAR(255),\\n    grade VARCHAR(1),\\n    GPA DECIMAL(3,2)\\n)\"], \"oraclesql\": [\"CREATE TABLE students (\\n    student_id NUMBER ,\\n    name VARCHAR2(255),\\n    major VARCHAR2(255)\\n)\", \"CREATE TABLE courses (\\n    course_id NUMBER ,\\n    name VARCHAR2(255),\\n    credits NUMBER,\\n    major VARCHAR2(255),\\n    mandatory VARCHAR2(3) CHECK (mandatory IN ('Yes', 'No')) \\n)\", \"CREATE TABLE enrollments (\\n    student_id NUMBER,\\n    course_id NUMBER,\\n    semester VARCHAR2(255),\\n    grade VARCHAR2(1),\\n    GPA Number (3,2)\\n)\"], \"database\": true, \"name\": \"find_top_scoring_students\", \"pythondata\": [\"students = pd.DataFrame([], columns=['student_id', 'name', 'major']).astype({\\n    'student_id': 'Int64',  # Nullable integer type for student_id\\n    'name': 'string',       # String type for names\\n    'major': 'string'       # String type for majors\\n})\", \"courses = pd.DataFrame([], columns=['course_id', 'name', 'credits', 'major', 'mandatory']).astype({'course_id': 'Int64', 'name': 'string', 'credits': 'Int64', 'major': 'string', 'mandatory': 'string'})\\n\\n # pd.CategoricalDtype(categories=['yes', 'no'])\\n\", \"enrollments = pd.DataFrame([], columns=['student_id', 'course_id', 'semester', 'grade', 'GPA']).astype({'student_id': 'Int64', 'course_id': 'Int64', 'semester': 'string', 'grade': 'string', 'GPA': 'float'})\\n\"], \"postgresql\": [\"CREATE TABLE IF NOT EXISTS students (\\n    student_id SERIAL,\\n    name VARCHAR(255),\\n    major VARCHAR(255)\\n);\", \"CREATE TABLE courses (\\n    course_id INTEGER,  -- or SERIAL if you want auto-increment\\n    name VARCHAR(255),\\n    credits INTEGER,    -- or NUMERIC if you need decimal places\\n    major VARCHAR(255),\\n    mandatory VARCHAR(3) CHECK (mandatory IN ('Yes', 'No'))\\n);\\n\", \"CREATE TABLE IF NOT EXISTS enrollments (\\n    student_id INT,\\n    course_id INT,\\n    semester VARCHAR(255),\\n    grade VARCHAR(10),\\n    GPA NUMERIC(3,2)\\n);\\n\"], \"database_schema\": {\"students\": {\"student_id\": \"INT\", \"name\": \"VARCHAR(255)\", \"major\": \"VARCHAR(255)\"}, \"courses\": {\"course_id\": \"INT\", \"name\": \"VARCHAR(255)\", \"credits\": \"INT\", \"major\": \"VARCHAR(255)\", \"mandatory\": \"ENUM('yes', 'no')\"}, \"enrollments\": {\"student_id\": \"INT\", \"course_id\": \"INT\", \"semester\": \"VARCHAR(255)\", \"grade\": \"VARCHAR(10)\", \"GPA\": \"DECIMAL(3, 2)\"}}}",
  "sampleTestCase": "{\"headers\":{\"students\":[\"student_id\",\"name\",\"major\"],\"courses\":[\"course_id\",\"name\",\"credits\",\"major\",\"mandatory\"],\"enrollments\":[\"student_id\",\"course_id\",\"semester\",\"grade\",\"GPA\"]},\"rows\":{\"students\":[[1,\"Alice\",\"Computer Science\"],[2,\"Bob\",\"Computer Science\"],[3,\"Charlie\",\"Mathematics\"],[4,\"David\",\"Mathematics\"]],\"courses\":[[101,\"Algorithms\",3,\"Computer Science\",\"Yes\"],[102,\"Data Structures\",3,\"Computer Science\",\"Yes\"],[103,\"Calculus\",4,\"Mathematics\",\"Yes\"],[104,\"Linear Algebra\",4,\"Mathematics\",\"Yes\"],[105,\"Machine Learning\",3,\"Computer Science\",\"No\"],[106,\"Probability\",3,\"Mathematics\",\"No\"],[107,\"Operating Systems\",3,\"Computer Science\",\"No\"],[108,\"Statistics\",3,\"Mathematics\",\"No\"]],\"enrollments\":[[1,101,\"Fall 2023\",\"A\",4.0],[1,102,\"Spring 2023\",\"A\",4.0],[1,105,\"Spring 2023\",\"A\",4.0],[1,107,\"Fall 2023\",\"B\",3.5],[2,101,\"Fall 2023\",\"A\",4.0],[2,102,\"Spring 2023\",\"B\",3.0],[3,103,\"Fall 2023\",\"A\",4.0],[3,104,\"Spring 2023\",\"A\",4.0],[3,106,\"Spring 2023\",\"A\",4.0],[3,108,\"Fall 2023\",\"B\",3.5],[4,103,\"Fall 2023\",\"B\",3.0],[4,104,\"Spring 2023\",\"B\",3.0]]}}"
}