{
  "questionId": "3288",
  "questionFrontendId": "2991",
  "title": "Top Three Wineries ",
  "titleSlug": "top-three-wineries",
  "content": "<p>Table: <code>Wineries</code></p>\n\n<pre>\n+-------------+----------+\n| Column Name | Type     |\n+-------------+----------+\n| id          | int      |\n| country     | varchar  |\n| points      | int      |\n| winery      | varchar  |\n+-------------+----------+\nid is column of unique values for this table.\nThis table contains id, country, points, and winery.\n</pre>\n\n<p>Write a solution to find the <strong>top three wineries</strong> in <strong>each</strong> <strong>country</strong> based on their <strong>total points</strong>. If <strong>multiple wineries</strong> have the <strong>same</strong> total points, order them by <code>winery</code> name in <strong>ascending</strong> order. If there&#39;s <strong>no second winery</strong>, output &#39;No second winery,&#39; and if there&#39;s <strong>no third winery</strong>, output &#39;No third winery.&#39;</p>\n\n<p>Return <em>the result table ordered by </em><code>country</code><em> in <strong>ascending</strong> order</em><em>.</em></p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nWineries table:\n+-----+-----------+--------+-----------------+\n| id  | country   | points | winery          | \n+-----+-----------+--------+-----------------+\n| 103 | Australia | 84     | WhisperingPines | \n| 737 | Australia | 85     | GrapesGalore    |    \n| 848 | Australia | 100    | HarmonyHill     | \n| 222 | Hungary   | 60     | MoonlitCellars  | \n| 116 | USA       | 47     | RoyalVines      | \n| 124 | USA       | 45     | Eagle&#39;sNest     | \n| 648 | India     | 69     | SunsetVines     | \n| 894 | USA       | 39     | RoyalVines      |  \n| 677 | USA       | 9      | PacificCrest    |  \n+-----+-----------+--------+-----------------+\n<strong>Output:</strong> \n+-----------+---------------------+-------------------+----------------------+\n| country   | top_winery          | second_winery     | third_winery         |\n+-----------+---------------------+-------------------+----------------------+\n| Australia | HarmonyHill (100)   | GrapesGalore (85) | WhisperingPines (84) |\n| Hungary   | MoonlitCellars (60) | No second winery  | No third winery      | \n| India     | SunsetVines (69)    | No second winery  | No third winery      |  \n| USA       | RoyalVines (86)     | Eagle&#39;sNest (45)  | PacificCrest (9)     | \n+-----------+---------------------+-------------------+----------------------+\n<strong>Explanation</strong>\nFor Australia\n - HarmonyHill Winery accumulates the highest score of 100 points in Australia.\n - GrapesGalore Winery has a total of 85 points, securing the second-highest position in Australia.\n - WhisperingPines Winery has a total of 80 points, ranking as the third-highest.\nFor Hungary\n - MoonlitCellars is the sole winery, accruing 60 points, automatically making it the highest. There is no second or third winery.\nFor India\n - SunsetVines is the sole winery, earning 69 points, making it the top winery. There is no second or third winery.\nFor the USA\n - RoyalVines Wines accumulates a total of 47 + 39 = 86 points, claiming the highest position in the USA.\n - Eagle&#39;sNest has a total of 45 points, securing the second-highest position in the USA.\n - PacificCrest accumulates 9 points, ranking as the third-highest winery in the USA\nOutput table is ordered by country in ascending order.\n</pre>\n",
  "difficulty": "Hard",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "PostgreSQL",
      "code": "-- Write your PostgreSQL query statement below\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    },
    {
      "lang": "Pandas",
      "code": "import pandas as pd\n\ndef top_three_wineries(wineries: pd.DataFrame) -> pd.DataFrame:\n    "
    }
  ],
  "stats": "{\"totalAccepted\": \"3.5K\", \"totalSubmission\": \"6.5K\", \"totalAcceptedRaw\": 3486, \"totalSubmissionRaw\": 6490, \"acRate\": \"53.7%\"}",
  "metaData": "{\"mysql\": [\"Create table if Not Exists Wineries ( id int, country varchar(60), points int, winery varchar(60))\"], \"mssql\": [\"Create table Wineries ( id int, country varchar(60), points int, winery varchar(60))\"], \"oraclesql\": [\"Create table  Wineries ( id int, country varchar(60), points int, winery varchar(60))\"], \"database\": true, \"name\": \"top_three_wineries\", \"postgresql\": [\"CREATE TABLE IF NOT EXISTS Wineries (\\n  id INT,\\n  country VARCHAR(60),\\n  points INT,\\n  winery VARCHAR(60)\\n);\"], \"pythondata\": [\"Wineries = pd.DataFrame([], columns=['id', 'country', 'points', 'winery']).astype({'id':'Int64', 'country':'object', 'points':'Int64', 'winery':'object'})\\n\"], \"database_schema\": {\"Wineries\": {\"id\": \"INT\", \"country\": \"VARCHAR(60)\", \"points\": \"INT\", \"winery\": \"VARCHAR(60)\"}}}",
  "sampleTestCase": "{\"headers\":{\"Wineries\":[\"id\",\"country\",\"points\",\"winery\"]},\"rows\":{\"Wineries\":[[103,\"Australia\",84,\"WhisperingPines\"],[737,\"Australia\",85,\"GrapesGalore\"],[848,\"Australia\",100,\"HarmonyHill\"],[222,\"Hungary\",60,\"MoonlitCellars\"],[116,\"USA\",47,\"RoyalVines\"],[124,\"USA\",45,\"Eagle'sNest\"],[648,\"India\",69,\"SunsetVines\"],[894,\"USA\",39,\"RoyalVines\"],[677,\"USA\",9,\"PacificCrest\"]]}}"
}