{
  "questionId": "3660",
  "questionFrontendId": "3338",
  "title": "Second Highest Salary II",
  "titleSlug": "second-highest-salary-ii",
  "content": "<p>Table: <code>employees</code></p>\n\n<pre>\n+------------------+---------+\n| Column Name      | Type    |\n+------------------+---------+\n| emp_id           | int     |\n| salary           | int     |\n| dept             | varchar |\n+------------------+---------+\nemp_id is the unique key for this table.\nEach row of this table contains information about an employee including their ID, salary, and department.\n</pre>\n\n<p>Write a solution to find the employees who earn the <strong>second-highest salary</strong> in each department. If <strong>multiple employees have the second-highest salary</strong>, <strong>include</strong> <strong>all employees</strong> with <strong>that salary</strong>.</p>\n\n<p>Return <em>the result table</em> <em>ordered by</em> <code>emp_id</code> <em>in</em> <em><strong>ascending</strong></em> <em>order</em>.</p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong></p>\n\n<p>employees table:</p>\n\n<pre class=\"example-io\">\n+--------+--------+-----------+\n| emp_id | salary | dept      |\n+--------+--------+-----------+\n| 1      | 70000  | Sales     |\n| 2      | 80000  | Sales     |\n| 3      | 80000  | Sales     |\n| 4      | 90000  | Sales     |\n| 5      | 55000  | IT        |\n| 6      | 65000  | IT        |\n| 7      | 65000  | IT        |\n| 8      | 50000  | Marketing |\n| 9      | 55000  | Marketing |\n| 10     | 55000  | HR        |\n+--------+--------+-----------+\n</pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"example-io\">\n+--------+-----------+\n| emp_id | dept      |\n+--------+-----------+\n| 2      | Sales     |\n| 3      | Sales     |\n| 5      | IT        |\n| 8      | Marketing |\n+--------+-----------+\n</pre>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>Sales Department</strong>:\n\n\t<ul>\n\t\t<li>Highest salary is 90000 (emp_id: 4)</li>\n\t\t<li>Second-highest salary is 80000 (emp_id: 2, 3)</li>\n\t\t<li>Both employees with salary 80000 are included</li>\n\t</ul>\n\t</li>\n\t<li><strong>IT Department</strong>:\n\t<ul>\n\t\t<li>Highest salary is 65000 (emp_id: 6, 7)</li>\n\t\t<li>Second-highest salary is 55000 (emp_id: 5)</li>\n\t\t<li>Only emp_id 5 is included as they have the second-highest salary</li>\n\t</ul>\n\t</li>\n\t<li><strong>Marketing Department</strong>:\n\t<ul>\n\t\t<li>Highest salary is 55000 (emp_id: 9)</li>\n\t\t<li>Second-highest salary is 50000 (emp_id: 8)</li>\n\t\t<li>Employee 8&nbsp;is included</li>\n\t</ul>\n\t</li>\n\t<li><strong>HR Department</strong>:\n\t<ul>\n\t\t<li>Only has one employee</li>\n\t\t<li>Not included in the result as it has fewer than 2 employees</li>\n\t</ul>\n\t</li>\n</ul>\n</div>\n",
  "difficulty": "Medium",
  "codeSnippets": [
    {
      "lang": "MySQL",
      "code": "# Write your MySQL query statement below\n"
    },
    {
      "lang": "MS SQL Server",
      "code": "/* Write your T-SQL query statement below */\n"
    },
    {
      "lang": "PostgreSQL",
      "code": "-- Write your PostgreSQL query statement below\n"
    },
    {
      "lang": "Oracle",
      "code": "/* Write your PL/SQL query statement below */\n"
    },
    {
      "lang": "Pandas",
      "code": "import pandas as pd\n\ndef find_second_highest_salary(employees: pd.DataFrame) -> pd.DataFrame:\n    "
    }
  ],
  "stats": "{\"totalAccepted\": \"2.8K\", \"totalSubmission\": \"3.2K\", \"totalAcceptedRaw\": 2798, \"totalSubmissionRaw\": 3237, \"acRate\": \"86.4%\"}",
  "metaData": "{\"mysql\": [\"Create table if not exists Employees (\\n    emp_id int,\\n    salary int,\\n    dept varchar(50)\\n)\"], \"mssql\": [\"Create table Employees (\\n    emp_id int,\\n    salary int,\\n    dept varchar(50)\\n)\"], \"oraclesql\": [\"Create table Employees (\\n    emp_id number,\\n    salary number,\\n    dept varchar2(50)\\n)\"], \"database\": true, \"name\": \"find_second_highest_salary\", \"postgresql\": [\"CREATE TABLE IF NOT EXISTS Employees (\\n    emp_id INT,\\n    salary INT,\\n    dept VARCHAR(50)\\n);\\n\"], \"pythondata\": [\"employees = pd.DataFrame({\\n    'emp_id': pd.Series(dtype='int'),\\n    'salary': pd.Series(dtype='int'),\\n    'dept': pd.Series(dtype='string')\\n})\"], \"database_schema\": {\"Employees\": {\"emp_id\": \"INT\", \"salary\": \"INT\", \"dept\": \"VARCHAR(50)\"}}}",
  "sampleTestCase": "{\"headers\":{\"employees\":[\"emp_id\",\"salary\",\"dept\"]},\"rows\":{\"employees\":[[1,70000,\"Sales\"],[2,80000,\"Sales\"],[3,80000,\"Sales\"],[4,90000,\"Sales\"],[5,55000,\"IT\"],[6,65000,\"IT\"],[7,65000,\"IT\"],[8,50000,\"Marketing\"],[9,55000,\"Marketing\"],[10,55000,\"HR\"]]}}"
}